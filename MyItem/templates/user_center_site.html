{% extends 'base_user_center.html' %}
{% block header_con %}
    <script type="text/javascript" src="../static/js/jquery-1.12.4.min.js"></script>
    <script src="../static/js/jquery-1.12.4.min.js"></script>
    <script type="text/javascript">
        $(function () {
            //发送省份请求，显示所有的省份
            province();
            //为省份绑定事件
            change_province();
            //为市区绑定事件
            change_city();
        });
        function province() {
            $.ajax({
                url:'/user/get_all_province',
                success:function (data) {
                    province_list = eval('('+data.province_list+')');
                    $.each(province_list,function (index,item) {
                        var option='<option value="'+item.pk+'">'+item.fields.name+'</option>';
                        $('#province_id').append(option)
                    })
                }
            })
        }
        function change_province() {
            $('#province_id').change(function () {
                province_id = $('#province_id').val();
                $('#city_id').html('<option value="0">- - - - -</option>');
                $('#town_id').html('<option value="0">- - - - -</option>');
                if (province_id != 0){
                    $.ajax({
                        url:'/user/get_city_by_province_code',
                        data:{'province_id':province_id},
                        success:function (data) {
                            city_list = eval('('+data.city_list+')');
                            $.each(city_list,function (index,item) {
                                var option='<option value="'+item.pk+'">'+item.fields.name+'</option>';
                                $('#city_id').append(option)
                            })
                        }
                    })
                }

            })
        }
        function change_city() {
            $('#city_id').change(function () {
                city_id = $('#city_id').val();
                $('#town_id').html('<option value="0">- - - - -</option>');
                if (city_id != 0){
                    $.ajax({
                        url:'../user/get_town_by_city_code',
                        data:{'city_id':city_id},
                        success:function (data) {
                            town_list = eval('('+data.town_list+')');
                            $('#town_id').html('<option value="0">- - - - -</option>');
                            $.each(town_list,function (index,item) {
                                var option='<option value="'+item.pk+'">'+item.fields.name+'</option>';
                                $('#town_id').append(option)
                            })
                        }
                    })
                }
            })
        }
    </script>
{% endblock header_con %}
{% block right_content %}
		<div class="right_content clearfix">
            <h3 class="common_title2">收货地址</h3>
            <div class="site_con">
                <dl>
                    <dt>当前地址：</dt>
                    {% if address %}
                        <dd>{{ address.addr }}  ({{ address.receiver }} 收)  {{ address.phone }}</dd>
                    {% else %}
                        <dd>无默认地址</dd>
                    {% endif %}
                </dl>
            </div>
            <h3 class="common_title2">编辑地址</h3>
            <div class="site_con">
                <span style="margin-left: 100px;color: #e62e2e;">{{ errmsg }}</span>
                <form method="post" action="{% url 'user:address' %}">
                    {% csrf_token %}
                    <div class="form_group">
                        <label>收件人：</label>
                        <input type="text" name="receiver">
                    </div>
                    <div class="form_group form_group2">
                        <label>地址信息：</label>
                        省：<select name="province_id" id="province_id" class="check"><option value="0">- - - - -</option></select>
                        市：<select name="city_id" id="city_id" class="check"><option value="0">- - - - -</option></select>
                        区/县：<select name="town_id" id="town_id" class="check"><option value="0">- - - - -</option></select>
                    </div>
                    <div class="form_group form_group3">
                        <label>详细地址：</label>
                        <textarea class="site_area" name="addr"></textarea>
                    </div>
                    <div class="form_group">
                        <label>邮编：</label>
                        <input type="text" name="zip_code">
                    </div>
                    <div class="form_group">
                        <label>手机：</label>
                        <input type="text" name="phone">
                    </div>

                    <input type="submit" name="" value="提交" class="info_submit">
                </form>
            </div>
		</div>
{% endblock right_content %}